---
title: "HIV_HERV"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## load packages
```{r}
library(tidyverse)
library(data.table)
library(PCAtools)
library(dplyr)
library(matrixStats)
library(edgeR)
library(DESeq2)
library(EnhancedVolcano)
library(ashr)
library(cowplot)
library(ggsci)
library(ggplot2)
library(ggpubr)
library(fgsea)
library(pheatmap)
library(scales)
library(scopetools)
library(pheatmap)
library(ggVennDiagram)
library(dplyr)
library(magrittr)
library(reshape)
library(RColorBrewer)
```

##Gut Biopses

```{r}
##Set to personal directory
setwd("D:\\Nixon Lab/HERV Gut - interferome Mario Paper/RDirectory/HIV_HERV/")
###########Scopetools##################################
####Create a list of sample names

sam_names_dir <- gsub(paste("Raw Data/telescope1/","\\/",sep = ""),"",list.dirs("Raw Data/telescope1/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv <- load_telescope_reports(files = paste("Raw Data/telescope1/",sam_names_dir,"/",sam_names_dir,".tsv", sep = ""), colnames = sam_names_dir)


##filter lowly abundant retrotransposons
cutoff.count <- 2
cutoff.sample <- floor(ncol(raw_herv) * 0.1)
raw_herv <- raw_herv[rowSums(raw_herv > cutoff.count) > cutoff.sample, ]
raw_herv <- raw_herv[!(row.names(raw_herv) %in% "__no_feature"),]
```

##DESEQ2 Gut Biopses

```{r}
ddsf <- read.csv(file = "PRJNA558500MetaData.csv")
ddsf2 <- read.csv(file = "Meta2.csv")
rownames(ddsf) <- ddsf$Sample.Name
#for some reason MIHIV188 keeps changing to MIHIV88, so changing the name permanently in the metadata for consistency
rownames(ddsf2) <- ddsf2$MIHIVode
combined_ddsf <- cbind(ddsf2, ddsf[rownames(ddsf2),])
ddsf <- combined_ddsf
rownames(ddsf) <- ddsf$ï..Run
ddsf[which(ddsf$disease == ""),"disease"] <- "HIVneg"
ddsf[which(ddsf$disease == "HIV-1"),"disease"] <- "HIVpos"
dds <- DESeqDataSetFromMatrix(countData = raw_herv, colData = ddsf[colnames(raw_herv),], design = ~ disease)
dds$disease <- relevel(dds$disease, ref = "HIVneg")
dds <- DESeq(dds)
resultsNames(dds)

##disease_HIVpos_vs_HIVneg.

resultsdds <- results(dds, name = "disease_HIVpos_vs_HIVneg")
```

##Make Volcano Plot Gut Biopses

```{r}
pdf("HIV+ vs HIV-.pdf")

keyvals.colour <- ifelse(
    resultsdds$padj > 0.05, 'black',
      ifelse(resultsdds$log2FoldChange > 1, '#063970',ifelse(
             resultsdds$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.colour[is.na(keyvals.colour)] <- 'black'
  names(keyvals.colour)[keyvals.colour == '#063970'] <- 'Upregulated'
  names(keyvals.colour)[keyvals.colour == 'black'] <- 'Unchanged'
  names(keyvals.colour)[keyvals.colour == '#Ff6300'] <- 'Downregulated'

EnhancedVolcano::EnhancedVolcano(resultsdds, lab = rownames(resultsdds), x = 'log2FoldChange', y = 'padj', title = 'HIVneg vs HIVpos Gut Biopsies', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-4, 4), ylim = c(0, 15), colCustom = keyvals.colour)

dev.off()
```

##Make PCA Gut Biopses

```{r}
vst <- assay(vst(dds))
p <- pca(vst, metadata = colData(dds), removeVar = 0.1)

pdf("SCREE plot.pdf")
screeplot(p, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot.pdf")
biplot(p, lab = p$disease, labSize = 2, pointSize = 2, colby = 'disease', shape = 'Sex', legendTitleSize = 0, showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-60,60), title = 'HIVneg vs HIVpos Gut Biopsies') 

dev.off()
```

##Summary Data Bar Charts Function
```{r}
#count_mat: the count matrix; meta = metadata; annotation = TE or gene annotation, the summary category table to build stack plot from; category = the category from annotation table to summarize from; cont = the contrast group from matadata
annotation <- read.delim("TE_annotation.v2.0.tsv", row.names = 1)
meta <- ddsf
meta[which(meta$disease == ""),"disease"] <- "HIVneg"
meta[which(meta$disease == "HIV-1"),"disease"] <- "HIVpos"
  
abundance_sum <- function(count_mat,meta, annotation, category, cont = "disease"){
  sum_table <- data.frame(matrix(ncol = 5))
  colnames(sum_table) <- c(cont, category, "Count","PCT","AvgCount")
  e.te.annot <- annotation[rownames(count_mat),,drop = FALSE]
  e.te.annot$ids <- rownames(e.te.annot)
  meta$ids <- rownames(meta)
  for(trait in unique(meta[,cont])){
    sample_sub <- meta[which(meta[,cont] == trait),"ids"]
    #print(sample_sub)
    for(sub_cat in unique(e.te.annot[,category])){
      #print(which(e.te.annot[,category] == sub_cat))
      sub_cat_rows <- e.te.annot[which(e.te.annot[,category] == sub_cat),"ids"]
      #print(sub_cat_rows[1])
      count_mat_sub_rows <- count_mat[sub_cat_rows,sample_sub]
      #print(count_mat_sub_rows)
      sum_table[nrow(sum_table) + 1,c(1:3,5)] <- c(trait, sub_cat, sum(count_mat_sub_rows), round(sum(count_mat_sub_rows)/ncol(count_mat_sub_rows),2))
    }
    sum_table$Count <- as.numeric(sum_table$Count)
    sum_table$AvgCount <- as.numeric(sum_table$AvgCount)
    stat_row_sum <- sum(sum_table[which(sum_table[,cont] == trait),"Count"])
    sum_table[which(sum_table[,cont] == trait),4] <- round(((sum_table[which(sum_table[,cont] == trait), "Count"])/stat_row_sum)*100,2)
  }
  sum_table <- sum_table[-1,]
  return(sum_table)
}
```

##Run Function

```{r}
herv_Category <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Category", cont = "disease")

herv_Class <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Class", cont = "disease")

herv_Chrom<- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Chrom", cont = "disease")

TE_type <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "TE_type", cont = "disease")

herv_Family <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Family", cont = "disease")
```

##Plot Summary

```{r}
#group
pdf("group_count.pdf", width=3.5, height=4)

ggplot(herv_Category, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Category, -AvgCount))) + geom_bar(stat = "identity", size=0.1, colour = "white") + xlab("")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Category")) + scale_fill_brewer(palette="Paired") + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#custom expanded color palette from color brewer "paired" panel
nb.cols_TE_Family <- 60
mycolors_TE_Family <- colorRampPalette(brewer.pal(12, "Paired"))(nb.cols_TE_Family)

#custom expanded color palette from color brewer "paired" panel
nb.cols_Chromosomes <- 35
mycolors_TE_Chromosomes <- colorRampPalette(brewer.pal(12, "Paired"))(nb.cols_Chromosomes)

#class
pdf("group_class.pdf", width=3.5, height=4)

ggplot(herv_Class, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Class, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Class")) + scale_fill_brewer(palette="Paired")  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#chrom
pdf("group_chrom.pdf", width=4.5, height=4)

ggplot(herv_Chrom, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Chrom, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Chrom"))  + scale_fill_manual(values = mycolors_TE_Chromosomes)  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#TE_type
pdf("TE_type.pdf", width=3.5, height=4)

ggplot(TE_type, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(TE_type, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE type")) + scale_fill_brewer(palette="Paired")  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#Family
pdf("TE Family.pdf", width=4.5, height=4)

ggplot(herv_Family, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Family, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Family"))  + scale_fill_manual(values = mycolors_TE_Family) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#groupPCT
pdf("group_count_pct.pdf", width=3.5, height=4)

ggplot(herv_Category, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Category, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "HERV Category")) + scale_fill_brewer(palette="Paired")  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#classPCT
pdf("group_class_pct.pdf", width=3.5, height=4)

ggplot(herv_Class, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Class, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "TE Class")) + scale_fill_brewer(palette="Paired")  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#chromPCT
pdf("group_chrom_pct.pdf", width=4.5, height=4)

ggplot(herv_Chrom, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Chrom, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "TE Chrom")) + scale_fill_manual(values = mycolors_TE_Chromosomes) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#TE_typePCT
pdf("TE_type_pct.pdf", width=3.5, height=4)

ggplot(TE_type, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(TE_type, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "TE type")) + scale_fill_brewer(palette="Paired")  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#familyPCT
pdf("TE_family_pct.pdf", width=4.5, height=4)

ggplot(herv_Family, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Family, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "TE Family")) + scale_fill_manual(values = mycolors_TE_Family)  + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()
```


##Interferome

```{r}
####Create a list of sample names
sam_names_dir_interferome <- gsub(paste("Raw Data Interferome/telescope1/","\\/",sep = ""),"",list.dirs("Raw Data Interferome/telescope1/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv_interferome <- load_telescope_reports(files = paste("Raw Data Interferome/telescope1/", sam_names_dir_interferome,"/",sam_names_dir_interferome,".tsv", sep = ""), colnames = sam_names_dir_interferome)

##filter lowly abundant retrotransposons
cutoff.count <- 2
cutoff.sample <- floor(ncol(raw_herv_interferome) * 0.1)
raw_herv_interferome <- raw_herv_interferome[rowSums(raw_herv_interferome > cutoff.count) > cutoff.sample, ]
raw_herv_interferome <- raw_herv_interferome[!(row.names(raw_herv_interferome) %in% "__no_feature"),]
```


##Summary Data Bar Charts Interferome

```{r}
#count_mat: the count matrix; meta = metadata; annotation = TE or gene annotation, the summary category table to build stack plot from; category = the category from annotation table to summarize from; cont = the contrast group from matadata
meta_int <- ddsf_Interferome
rownames(meta_int) <- meta_int$`ï..Run`

  
abundance_sum_int <- function(count_mat,meta, annotation, category, cont = "Library.Name"){
  sum_table <- data.frame(matrix(ncol = 5))
  colnames(sum_table) <- c(cont, category, "Count","PCT","AvgCount")
  e.te.annot <- annotation[rownames(count_mat),,drop = FALSE]
  e.te.annot$ids <- rownames(e.te.annot)
  meta$ids <- rownames(meta)
  for(trait in unique(meta[,cont])){
    sample_sub <- meta[which(meta[,cont] == trait),"ids"]
    #print(sample_sub)
    for(sub_cat in unique(e.te.annot[,category])){
      #print(which(e.te.annot[,category] == sub_cat))
      sub_cat_rows <- e.te.annot[which(e.te.annot[,category] == sub_cat),"ids"]
      #print(sub_cat_rows[1])
      count_mat_sub_rows <- count_mat[sub_cat_rows,sample_sub]
      #print(count_mat_sub_rows)
      sum_table[nrow(sum_table) + 1,c(1:3,5)] <- c(trait, sub_cat, sum(count_mat_sub_rows), round(sum(count_mat_sub_rows)/ncol(count_mat_sub_rows),2))
    }
    sum_table$Count <- as.numeric(sum_table$Count)
    sum_table$AvgCount <- as.numeric(sum_table$AvgCount)
    stat_row_sum <- sum(sum_table[which(sum_table[,cont] == trait),"Count"])
    sum_table[which(sum_table[,cont] == trait),4] <- round(((sum_table[which(sum_table[,cont] == trait), "Count"])/stat_row_sum)*100,2)
  }
  sum_table <- sum_table[-1,]
  return(sum_table)
}
```

##Run Function Interferome

```{r}
herv_Category_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Category", cont = "Library.Name")

herv_Class_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Class", cont = "Library.Name")

herv_Chrom_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Chrom", cont = "Library.Name")

TE_type_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "TE_type", cont = "Library.Name")

TE_Family_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Family", cont = "Library.Name")
```

##Plot Summary Interferome

```{r}
#group
pdf("group_count_int.pdf", width=4, height=4)

ggplot(herv_Category_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = AvgCount, fill = reorder(Category, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Average Count Per Sample") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#class
pdf("group_class_int.pdf", width=4, height=4)
ggplot(herv_Class_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5","a8", "a14", "b")), y = AvgCount, fill = reorder(Class, -AvgCount))) + geom_bar(stat = "identity", size=0.1) + xlab("Interferon Type")+ ylab("Average Count Per Sample") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "HERV Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#chrom
pdf("group_chrom_int.pdf", width=5, height=4)

ggplot(herv_Chrom_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = AvgCount, fill = reorder(Chrom, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Average Count Per Sample") + scale_fill_manual(values = mycolors_TE_Chromosomes)  + guides(fill = guide_legend(title = "Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#TE_type
pdf("TE_type_int.pdf", width=4, height=4)
ggplot(TE_type_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = AvgCount, fill = reorder(TE_type, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Average Count Per Sample") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "TE_type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#family
pdf("TE_Family_int.pdf", width=5, height=4)

ggplot(TE_Family_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = AvgCount, fill = reorder(Family, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Family"))+ scale_fill_manual(values = mycolors_TE_Family)   + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#groupPCT
pdf("group_count_int_pct.pdf", width=4, height=4)

ggplot(herv_Category_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = PCT, fill = reorder(Category, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Percent Abundance") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#classPCT
pdf("group_class_int_pct.pdf", width=4, height=4)
ggplot(herv_Class_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = PCT, fill = reorder(Class, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Percent Abundance") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "HERV Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#chromPCT
pdf("group_chrom_int_pct.pdf", width=5, height=4)
ggplot(herv_Chrom_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = PCT, fill = reorder(Chrom, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Percent Abundance") + scale_fill_manual(values = mycolors_TE_Chromosomes)  + guides(fill = guide_legend(title = "Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#TE_typePCT
pdf("TE_type_int_pct.pdf", width=4, height=4)
ggplot(TE_type_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = PCT, fill = reorder(TE_type, -PCT))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Percent Abundance") + scale_fill_brewer(palette="Paired")   + guides(fill = guide_legend(title = "TE_type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()

#family
pdf("TE_Family_int_pct.pdf", width=5, height=4)

ggplot(TE_Family_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b")), y = PCT, fill = reorder(Family, -AvgCount))) + geom_bar(stat = "identity", size=0) + xlab("Interferon Type")+ ylab("Percent Abundance") + guides(fill = guide_legend(title = "TE Family"))+ scale_fill_manual(values = mycolors_TE_Family)   + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black")) + theme(legend.key.size = unit(0.2, 'cm'), legend.text = element_text(size=6.8))

dev.off()
```

##DESEQ2 Interferome

```{r}
ddsf_Interferome <- read.csv(file = "PRJNA558974MetaData.csv")
rownames(ddsf_Interferome) <- ddsf_Interferome$ï..Run
dds_Interferome <- DESeqDataSetFromMatrix(countData = raw_herv_interferome[, rownames(ddsf_Interferome)], colData = ddsf_Interferome, design = ~ Library.Name)
#dds_Interferome$Library.Name <- relevel(dds_Interferome$Library.Name, ref = "m")
dds_Interferome <- DESeq(dds_Interferome, parallel = T, betaPrior = T)
resultsNames(dds_Interferome)
 
```

##Make Volcano Plot Library.Name_a1_vs_m

```{r}
#Null , xlim = c(, ), ylim = c(,) can be added for preference

resultsdds_Interferome_Library.Name_a1_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "a1", "m"))

keyvals.coloura1 <- ifelse(
    resultsdds_Interferome_Library.Name_a1_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_a1_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_a1_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura1[is.na(keyvals.coloura1)] <- 'black'
  names(keyvals.coloura1)[keyvals.coloura1 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == 'black'] <- 'Unregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == '#Ff6300'] <- 'Downregulated'
  
pdf("Library.Name_a1_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a1_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a1_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNa1', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura1)

dev.off()
```

##Make Volcano Plot Library.Name_a14_vs_m

```{r}

resultsdds_Interferome_Library.Name_a14_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "a14", "m"))

keyvals.coloura14 <- ifelse(
    resultsdds_Interferome_Library.Name_a14_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_a14_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_a14_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura14[is.na(keyvals.coloura14)] <- 'black'
  names(keyvals.coloura14)[keyvals.coloura14 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura14)[keyvals.coloura14 == 'black'] <- 'Unregulated'
  names(keyvals.coloura14)[keyvals.coloura14 == '#Ff6300'] <- 'Downregulated'

pdf("Library.Name_a14_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a14_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a14_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNa14', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura14)

dev.off()
```

##Make Volcano Plot Library.Name_a2_vs_m

```{r}
resultsdds_Interferome_Library.Name_a2_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "a2", "m"))

keyvals.coloura2 <- ifelse(
    resultsdds_Interferome_Library.Name_a2_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_a2_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_a2_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura2[is.na(keyvals.coloura2)] <- 'black'
  names(keyvals.coloura2)[keyvals.coloura2 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura2)[keyvals.coloura2 == 'black'] <- 'Unchanged'
  names(keyvals.coloura2)[keyvals.coloura2 == '#Ff6300'] <- 'Downregulated'

pdf("Library.Name_a2_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a2_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a2_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNa2', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura2)

dev.off()
```

##Make Volcano Plot Library.Name_a5_vs_m

```{r}
resultsdds_Interferome_Library.Name_a5_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "a5", "m"))

keyvals.coloura5 <- ifelse(
    resultsdds_Interferome_Library.Name_a5_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_a5_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_a5_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura5[is.na(keyvals.coloura5)] <- 'black'
  names(keyvals.coloura5)[keyvals.coloura5 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura5)[keyvals.coloura5 == 'black'] <- 'Unchanged'
  names(keyvals.coloura5)[keyvals.coloura5 == '#Ff6300'] <- 'Downregulated'

pdf("Library.Name_a5_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a5_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a5_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNa5', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura5)

dev.off()
```

##Make Volcano Plot Library.Name_a8_vs_m

```{r}
resultsdds_Interferome_Library.Name_a8_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "a8", "m"))

keyvals.coloura8 <- ifelse(
    resultsdds_Interferome_Library.Name_a2_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_a8_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_a8_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura8[is.na(keyvals.coloura8)] <- 'black'
  names(keyvals.coloura8)[keyvals.coloura8 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura8)[keyvals.coloura8 == 'black'] <- 'Unchanged'
  names(keyvals.coloura8)[keyvals.coloura8 == '#Ff6300'] <- 'Downregulated'

pdf("Library.Name_a8_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a8_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a8_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNa8', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura8)

dev.off()
```

##Make Volcano Plot Library.Name_b_vs_m

```{r}
resultsdds_Interferome_Library.Name_b_vs_m <- results(dds_Interferome, contrast=c("Library.Name", "b", "m"))

keyvals.colourb <- ifelse(
    resultsdds_Interferome_Library.Name_b_vs_m$padj > 0.05, 'black',
      ifelse(resultsdds_Interferome_Library.Name_b_vs_m$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_Interferome_Library.Name_b_vs_m$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.colourb[is.na(keyvals.colourb)] <- 'black'
  names(keyvals.colourb)[keyvals.colourb == '#063970'] <- 'Upregulated'
  names(keyvals.colourb)[keyvals.colourb == 'black'] <- 'Unchanged'
  names(keyvals.colourb)[keyvals.colourb == '#Ff6300'] <- 'Downregulated'

pdf("Library.Name_b_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_b_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_b_vs_m), x = 'log2FoldChange', y = 'padj', title = 'Mock vs IFNb', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.colourb)

dev.off()
```

##Make PCA Interferome

```{r}
vst_Interferome <- assay(vst(dds_Interferome))
p_Interferome <- pca(vst_Interferome, metadata = colData(dds_Interferome), removeVar = 0.1)

pdf("SCREE plot_Interferome.pdf")
screeplot(p_Interferome, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot_Interferome.pdf")
biplot(p_Interferome, lab = p_Interferome$Library.Name, labSize = 2, legendTitleSize = 0, pointSize = 2, colby = 'Library.Name', showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-50,50), title = 'IFN Stimulation')

dev.off()
```

##ggVennDiagram Interferome

```{r}
#upregulated
res_herv_pm_a1_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea1"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a2_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea2"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a5_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea5"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a8_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea8"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a14_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea14"), c("Library.Namem")))%>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_b_vs_m_up <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Nameb"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

#downregulated
res_herv_pm_a1_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea1"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a2_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea2"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a5_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea5"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a8_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea8"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_a14_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Namea14"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_herv_pm_b_vs_m_down <- results(dds_Interferome, independentFiltering = TRUE, contrast = list(c("Library.Nameb"), c("Library.Namem"))) %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

#upregulated vs m
ggVennUp <- list(res_herv_pm_a1_vs_m_up, res_herv_pm_a2_vs_m_up, res_herv_pm_a5_vs_m_up, res_herv_pm_a8_vs_m_up, res_herv_pm_a14_vs_m_up, res_herv_pm_b_vs_m_up)


pdf("Upregulated TEs Interferome.pdf")

ggVennDiagram(ggVennUp, label = "count", category.names = c("IFNa1","IFNa2","IFNa5", "IFNa8", "IFNa14", "IFNb")) + scale_fill_gradient(low = "#F4FAFE", high = "#063970")

dev.off()

#downregulated vs m
ggVennDown <- list(res_herv_pm_a1_vs_m_down, res_herv_pm_a2_vs_m_down, res_herv_pm_a5_vs_m_down,res_herv_pm_a8_vs_m_down, res_herv_pm_a14_vs_m_down, res_herv_pm_b_vs_m_down)

pdf("Downregulated TEs Interferome.pdf")

ggVennDiagram(ggVennDown, label = "count", category.names = c("IFNa1","IFNa2","IFNa5", "IFNa8", "IFNa14", "IFNb")) + scale_fill_gradient(low = "#F4FAFE", high = "#Ff6300")

dev.off()
```
 
##ggVennDiagram HIV+Int

```{r}
res_HIV_up <- resultsdds %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange >= 1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

res_HIV_down <- resultsdds %>% as.data.frame(.)  %>% dplyr::select(everything()) %>%
    filter(log2FoldChange <= -1) %>%
    filter(padj <= 0.05) %>%
    arrange(padj) %>% rownames()

VennDown <- list(res_HIV_down, res_herv_pm_a1_vs_m_down, res_herv_pm_a2_vs_m_down, res_herv_pm_a5_vs_m_down, res_herv_pm_a8_vs_m_down, res_herv_pm_a14_vs_m_down, res_herv_pm_b_vs_m_down)

VennUp <- list(res_HIV_up, res_herv_pm_a1_vs_m_up, res_herv_pm_a2_vs_m_up, res_herv_pm_a5_vs_m_up, res_herv_pm_a8_vs_m_up, res_herv_pm_a14_vs_m_up, res_herv_pm_b_vs_m_up)

pdf("Downregulated TEs Venn.pdf")

ggVennDiagram(VennDown, label = "count", category.names = c("HIV gut biopses", "IFNa1","IFNa2","IFNa5", "IFNa8", "IFNa14", "IFNb")) + scale_fill_gradient(low = "#F4FAFE", high = "#Ff6300")

dev.off()

pdf("Upregulated TEs Venn.pdf")

ggVennDiagram(VennUp, label = "count", category.names = c("HIV gut biopses", "IFNa1","IFNa2","IFNa5", "IFNa8", "IFNa14", "IFNb")) + scale_fill_gradient(low = "#F4FAFE", high = "#063970")

dev.off()
```

#Create List of shared TEs across datasets

```{r}
##Export List of Shared TEs

all_up <- Reduce(intersect,VennUp)

##all_up (List of 7)
## "MER101_2p25.2" "L1FLnI_1p22.2l" "HARLEQUIN_17q12" "MER4_7q21.2" "L1FLnI_17q12k" "L1FLnI_9p21.1ha" "HERV4_4q22.1"  

all_down <- Reduce(intersect,VennDown)

##all_down (List of 0)

Int_up <- Reduce(intersect,ggVennUp)

##Int_up (List of 24)
## "L1FLnI_2p25.2e"    "HUERSP3_2p25.2"    "HERVFH19_2p22.2"   "L1FLnI_9p21.1ha"   "L1FLnI_21q22.3a"   "HERV4_4q22.1"      "L1FLnI_2q37.1e"    "L1FLnI_12q24.13b"  "L1FLnI_3q21.1c"    "L1FLnI_7q21.2o"    "HARLEQUIN_17q12"   "HERVIP10FH_1q23.1" "MER101_2p25.2"     "L1FLnI_4q28.2l"    "MER4_7q21.2"       "L1FLnI_17q12k"     "L1FLnI_4q32.3da"   "MER4_22q12.3"     "L1FLnI_1p22.2l"    "L1FLnI_11q22.2b"   "L1FLnI_7q21.2p"    "L1FLnI_4q28.2h"    "HERVL74_17q12"     "L1FLnI_1p22.2j"

Int_down <- Reduce(intersect,ggVennDown)

##Int_down (List of 0)
```
##Heatmap color scheme

```{r}
HeatmapColPalette <- RColorBrewer::brewer.pal(11, "PRGn")
```


##Heatmaps Gut

```{r}
ddsSig <- subset(resultsdds, padj < 0.05)
ddsSig <- subset(ddsSig, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSig <- as.data.frame(ddsSig)
#Sort in descending order
ddsSig <- ddsSig[order(ddsSig$log2FoldChange, decreasing=TRUE),]

sort

dfGut <- vst(dds, blind = TRUE)
dfGutAll <- dfGut %>% assay(.)
dfGut <- dfGut[rownames(ddsSig),] %>% assay(.)

#Set color scale to match rest of data (HIVpos=blue, HIVneg=red)
annot_colors=list(disease=c(HIVneg="#F0978D",HIVpos="#63D7DE"))

pdf("Heatmap gut sig.pdf", height = 6, width = 4)
dfGut <- dfGut[, rownames(meta)[order(meta$disease)]]
pheatmap(dfGut, annotation_colors=annot_colors, scale="row",main = "HIVneg vs HIVpos Gut Biopsies",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta[,"disease",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap gut all.pdf", height = 6, width = 4)
dfGutAll_clust <- dfGutAll[, rownames(meta)[order(meta$disease)]]
pheatmap(dfGutAll_clust, annotation_colors=annot_colors, scale="row",main = "HIVneg vs HIVpos Gut Biopsies",fontsize = 10, size = 35, show_colnames = FALSE, show_rownames = FALSE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta[,"disease",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()
```

##Heatmap Interferome all

```{r}
#Subset genes from DESEQ data for individual heatmaps
ddsSiga1 <- subset(results(dds_Interferome, contrast=c("Library.Name", "a1", "m")), padj < 0.05)
ddsSiga1 <- subset(ddsSiga1, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSiga1 <- as.data.frame(ddsSiga1)
ddsSiga1 <- ddsSiga1[order(ddsSiga1$log2FoldChange, decreasing=TRUE),]

ddsSiga2<- subset(results(dds_Interferome, contrast=c("Library.Name", "a2", "m")), padj < 0.05)
ddsSiga2 <- subset(ddsSiga2, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSiga2 <- as.data.frame(ddsSiga2)
ddsSiga2 <- ddsSiga2[order(ddsSiga2$log2FoldChange, decreasing=TRUE),]

ddsSiga5<- subset(results(dds_Interferome, contrast=c("Library.Name", "a5", "m")), padj < 0.05)
ddsSiga5 <- subset(ddsSiga5, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSiga5 <- as.data.frame(ddsSiga5)
ddsSiga5 <- ddsSiga5[order(ddsSiga5$log2FoldChange, decreasing=TRUE),]

ddsSiga8<- subset(results(dds_Interferome, contrast=c("Library.Name", "a8", "m")), padj < 0.05)
ddsSiga8 <- subset(ddsSiga8, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSiga8 <- as.data.frame(ddsSiga8)
ddsSiga8 <- ddsSiga8[order(ddsSiga8$log2FoldChange, decreasing=TRUE),]

ddsSiga14<- subset(results(dds_Interferome, contrast=c("Library.Name", "a14", "m")), padj < 0.05)
ddsSiga14 <- subset(ddsSiga14, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSiga14 <- as.data.frame(ddsSiga14)
ddsSiga14 <- ddsSiga14[order(ddsSiga14$log2FoldChange, decreasing=TRUE),]

ddsSigb<- subset(results(dds_Interferome, contrast=c("Library.Name", "b", "m")), padj < 0.05)
ddsSigb <- subset(ddsSigb, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSigb <- as.data.frame(ddsSigb)
ddsSigb <- ddsSigb[order(ddsSigb$log2FoldChange, decreasing=TRUE),]

#VSTransform data
dfSigInt <- vst(dds_Interferome, blind = TRUE)
dfSigAll <- dfSigInt %>% assay(.)

#Subset data to plot
dfSiga1 <- dfSigInt[rownames(ddsSiga1),] %>% assay(.)

dfSiga2 <- dfSigInt[rownames(ddsSiga2),] %>% assay(.)

dfSiga5 <- dfSigInt[rownames(ddsSiga5),] %>% assay(.)

dfSiga8 <- dfSigInt[rownames(ddsSiga8),] %>% assay(.)

dfSiga14 <- dfSigInt[rownames(ddsSiga14),] %>% assay(.)

dfSigb <- dfSigInt[rownames(ddsSigb),] %>% assay(.)

pdf("Heatmap Interferome all.pdf", height = 6, width = 4)
dfSigAll_clust <- dfSigAll[, rownames(meta_int)[order(meta_int$Library.Name)]]
pheatmap(dfSigAll_clust, scale="row",main = "Type-I Interferons",fontsize = 10, size = 35, show_colnames = FALSE, show_rownames = FALSE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome a1.pdf", height = 6, width = 3)
dfSiga1_clust <- dfSiga1[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSiga1_clust <- data.frame(dfSiga1_clust[, c("SRR9904875", "SRR9904882", "SRR9904877", "SRR9904874", "SRR9904876", "SRR9904885")])
pheatmap(dfSiga1_clust, scale="row",main = "IFN alpha 1",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome a2.pdf", height = 6, width = 4)
dfSiga2_clust <- dfSiga2[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSiga2_clust <- data.frame(dfSiga2_clust[, c("SRR9904875", "SRR9904882", "SRR9904877","SRR9904873", "SRR9904879", "SRR9904884")])
pheatmap(dfSiga2_clust, scale="row",main = "IFN alpha 2",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome a5.pdf", height = 6, width = 4)
dfSiga5_clust <- dfSiga5[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSiga5_clust <- data.frame(dfSiga5_clust[, c("SRR9904875", "SRR9904882", "SRR9904877","SRR9904871", "SRR9904872", "SRR9904878")])
pheatmap(dfSiga5_clust, scale="row",main = "IFN alpha 5",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome a8.pdf", height = 6, width = 4)
dfSiga8_clust <- dfSiga8[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSiga8_clust <- data.frame(dfSiga8_clust[, c("SRR9904875", "SRR9904882", "SRR9904877","SRR9904867", "SRR9904881", "SRR9904870")])
pheatmap(dfSiga8_clust, scale="row",main = "IFN alpha 8",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome a14.pdf", height = 6, width = 4)
dfSiga14_clust <- dfSiga14[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSiga14_clust <- data.frame(dfSiga14_clust[, c("SRR9904875", "SRR9904882", "SRR9904877","SRR9904866", "SRR9904869", "SRR9904880")])
pheatmap(dfSiga14_clust, scale="row",main = "IFN 14",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()

pdf("Heatmap Interferome b.pdf", height = 6, width = 4)
dfSigb_clust <- dfSigb[, rownames(meta_int)[order(meta_int$Library.Name)]]
dfSigb_clust <- data.frame(dfSigb_clust[, c("SRR9904875", "SRR9904882", "SRR9904877","SRR9904886", "SRR9904883", "SRR9904868")])
pheatmap(dfSigb_clust, scale="row",main = "IFN beta",fontsize = 5, size = 35, show_colnames = FALSE, show_rownames = TRUE, cluster_cols = FALSE, cluster_rows = FALSE, legend_labels = "Expression Z-score", annotation_col = meta_int[,"Library.Name",drop = FALSE], color = hcl.colors(10000, "RdYlBu"))

dev.off()
```

##Boxplots

```{r}
#Plot Contrast Function for Tukey Box and Whisker Plots
#DESEQ utilizes Walds test for initial significance, post hoc data displayed here of significant results identified by deseq utilizes a T Test for p values
#Line = Median and Dot = Mean
plot_contrast <- function(count_table, metadata,category, herv, title = "Selected Counts", group = "2-side"){
  count_hervs <- cbind(t(count_table[herv,rownames(metadata), drop = FALSE]), metadata[, category,drop = FALSE])
  colnames(count_hervs) <- c("HERV","Category")
  if(group == "2-side"){
  herv_plot <- ggplot(count_hervs, aes(x = Category, y = HERV, color = Category)) + geom_boxplot(outlier.shape = NA)+ geom_jitter(size = 1, shape=16, position=position_jitter(0.2))+ stat_summary(fun.y=mean)+xlab(NULL)+ ylab(" Normalized Counts")+ggtitle(title)+theme(plot.title = element_text(size = 15, face = "bold"),axis.title=element_text(size=15,face="bold"),legend.title = element_text(size = 15,face="bold"),axis.text = element_text(size = 15),axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+ theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))}
  else{
    herv_plot <- ggplot(count_hervs, aes(x = Category, y = HERV, color = Category)) + geom_boxplot(outlier.shape = NA)+ geom_jitter(size = 1, shape=16, position=position_jitter(0.2))+ stat_summary(fun.y=mean)+xlab(NULL)+ ylab(" Normalized Counts")+ggtitle(title)+theme(plot.title = element_text(size = 15, face = "bold"),axis.title=element_text(size=15,face="bold"),legend.title = element_text(size = 15,face="bold"),axis.text = element_text(size = 15),axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+ theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  }
  return(print(herv_plot))}



#Gut Sample Matrix
dtMat <- counts(dds, normalized = TRUE)
### "MER101_2p25.2" "L1FLnI_1p22.2l" "HARLEQUIN_17q12" "MER4_7q21.2" "L1FLnI_17q12k" "L1FLnI_9p21.1ha" "HERV4_4q22.1"  

pdf("Gut_HERVH_6q23.1.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "HERVH_6q23.1", title = "HERVH_6q23.1")

dev.off()

pdf("Gut_MER101_2p25.2.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "MER101_2p25.2", title = "MER101_2p25.2")

dev.off()

pdf("Gut_L1FLnI_1q23.1t.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1q23.1t", title = "L1FLnI_1q23.1t")

dev.off()

pdf("Gut_L1FLnI_4p15.32e.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_4p15.32e", title = "L1FLnI_4p15.32e")

dev.off()

pdf("Gut_L1FLnI_1p31.1l.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1p31.1l", title = "L1FLnI_1p31.1l")

dev.off()

pdf("Gut_L1FLnI_8q21.3da.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_8q21.3da", title = "L1FLnI_8q21.3da")

dev.off()



#Interferome Matrix
dfSigIntMat <- counts(dds_Interferome, normalized = TRUE)
#Relevel order to put mock first
meta_int$Library.Name <- factor(meta_int$Library.Name, levels = c("m", "a1", "a2", "a5", "a8", "a14", "b"))

pdf("L1FLnI_2p25.2e.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_2p25.2e", title = "L1FLnI_2p25.2e", group = "multiple")

dev.off()

pdf("HERVFH19_2p22.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERVFH19_2p22.2", title = "HERVFH19_2p22.2", group = "multiple")

dev.off()

pdf("HUERSP3_2p25.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HUERSP3_2p25.2", title = "HUERSP3_2p25.2", group = "multiple")

dev.off()

pdf("L1FLnI_2q37.1e.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_2q37.1e", title = "L1FLnI_2q37.1e", group = "multiple")

dev.off()

pdf("L1FLnI_9p21.1ha.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_9p21.1ha", title = "L1FLnI_9p21.1ha", group = "multiple")

dev.off()

pdf("L1FLnI_21q22.3a.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_21q22.3a", title = "L1FLnI_21q22.3a", group = "multiple")

dev.off()

pdf("HERV4_4q22.1.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERV4_4q22.1", title = "HERV4_4q22.1", group = "multiple")

dev.off()

pdf("HERVIP10FH_1q23.1.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERVIP10FH_1q23.1", title = "HERVIP10FH_1q23.1", group = "multiple")

dev.off()

pdf("MER4_16q24.3.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "MER4_16q24.3", title = "MER4_16q24.3", group = "multiple")

dev.off()

pdf("HERVH_9q34.13.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERVH_9q34.13", title = "HERVH_9q34.13", group = "multiple")

dev.off()

pdf("L1FLnI_22q11.22b.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_22q11.22b", title = "L1FLnI_22q11.22b", group = "multiple")

dev.off()
```

#Shared TEs between gut and interferome
```{r}
### "MER101_2p25.2" "L1FLnI_1p22.2l" "HARLEQUIN_17q12" "MER4_7q21.2" "L1FLnI_17q12k" "L1FLnI_9p21.1ha" "HERV4_4q22.1" 
#Interferome
pdf("MER101_2p25.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "MER101_2p25.2", title = "MER101_2p25.2", group = "multiple")

dev.off()

pdf("L1FLnI_1p22.2l.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_1p22.2l", title = "L1FLnI_1p22.2l", group = "multiple")

dev.off()

pdf("HARLEQUIN_17q12.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HARLEQUIN_17q12", title = "HARLEQUIN_17q12", group = "multiple")

dev.off()

pdf("MER4_7q21.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "MER4_7q21.2", title = "MER4_7q21.2", group = "multiple")

dev.off()

pdf("L1FLnI_17q12k.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_17q12k", title = "L1FLnI_17q12k", group = "multiple")

dev.off()

pdf("L1FLnI_9p21.1ha.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_9p21.1ha", title = "L1FLnI_9p21.1ha", group = "multiple")

dev.off()

pdf("HERV4_4q22.1.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERV4_4q22.1", title = "HERV4_4q22.1", group = "multiple")

dev.off()


#Gut
### "MER101_2p25.2" "L1FLnI_1p22.2l" "HARLEQUIN_17q12" "MER4_7q21.2" "L1FLnI_17q12k" "L1FLnI_9p21.1ha" "HERV4_4q22.1" 
pdf("Gut_MER101_2p25.2.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "MER101_2p25.2", title = "MER101_2p25.2")

dev.off()

pdf("Gut_L1FLnI_1p22.2l.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1p22.2l", title = "L1FLnI_1p22.2l")

dev.off()

pdf("Gut_HARLEQUIN_17q12.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "HARLEQUIN_17q12", title = "HARLEQUIN_17q12")

dev.off()

pdf("Gut_MER4_7q21.2.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "MER4_7q21.2", title = "MER4_7q21.2")

dev.off()

pdf("Gut_L1FLnI_17q12k.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_17q12k", title = "L1FLnI_17q12k")

dev.off()

pdf("Gut_L1FLnI_9p21.1ha.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_9p21.1ha", title = "L1FLnI_9p21.1ha")

dev.off()

pdf("Gut_HERV4_4q22.1.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "HERV4_4q22.1", title = "HERV4_4q22.1")

dev.off()
```

##Interest from clinical parameters 
```{r}
#L1FLnI_1p22.2l, LTR19_12p13.31, L1FLnI_1q23.1t, HARLEQUIN_10q24.2, MER101_2p25.2, and HERVH_6q23.1

pdf("L1FLnI_1p22.2l.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_1p22.2l", title = "L1FLnI_1p22.2l", group = "multiple")

dev.off()

pdf("Gut_L1FLnI_1p22.2l.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1p22.2l", title = "L1FLnI_1p22.2l") + stat_compare_means(method = "t.test",label.x = 0.7, label.y =100)
dev.off()

pdf("LTR19_12p13.31.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "LTR19_12p13.31", title = "LTR19_12p13.31", group = "multiple")

dev.off()

pdf("Gut_LTR19_12p13.31.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "LTR19_12p13.31", title = "LTR19_12p13.31")

dev.off()

pdf("L1FLnI_1q23.1t.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_1q23.1t", title = "L1FLnI_1q23.1t", group = "multiple")

dev.off()

pdf("Gut_L1FLnI_1q23.1t.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1q23.1t", title = "L1FLnI_1q23.1t")

dev.off()

pdf("HARLEQUIN_10q24.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HARLEQUIN_10q24.2", title = "HARLEQUIN_10q24.2", group = "multiple")

dev.off()

pdf("Gut_HARLEQUIN_10q24.2.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "HARLEQUIN_10q24.2", title = "HARLEQUIN_10q24.2")

dev.off()

pdf("MER101_2p25.2.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "MER101_2p25.2", title = "MER101_2p25.2", group = "multiple")

dev.off()

pdf("Gut_MER101_2p25.2.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "MER101_2p25.2", title = "MER101_2p25.2")

dev.off()

pdf("HERVH_6q23.1.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "HERVH_6q23.1", title = "HERVH_6q23.1", group = "multiple")

dev.off()

pdf("Gut_HERVH_6q23.1.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "HERVH_6q23.1", title = "HERVH_6q23.1")

dev.off()
```


```{r}
meta$CD4a <- as.numeric(meta$CD4a)
herv_to_quantify <- rownames(ddsSig)
#should have not used "cd4a" in name, but it is okay. 
herv_table_cd4a <- data.frame(matrix(ncol = length(herv_to_quantify)+2, nrow = nrow(meta)))
colnames(herv_table_cd4a) <- c("Run","CD4a",herv_to_quantify)
rownames(herv_table_cd4a) <- rownames(meta)
for(herv in herv_to_quantify){
  for(item in unique(meta$ï..Run)){
    count_total <- sum(dtMat[herv,item])
    cd4a <- meta[item,"CD4a"]
    herv_table_cd4a[item,c("Run","CD4a",herv)] <- c(item,cd4a,count_total)
  }
}
herv_table_cd4a$CD4a <- as.numeric(herv_table_cd4a$CD4a)
herv_table_cd4a$disease <- meta[rownames(herv_table_cd4a),"disease"]
herv_table_cd4a$cd4 <- meta[rownames(herv_table_cd4a),"CD4"]
herv_table_cd4a$viral_load <- meta[rownames(herv_table_cd4a),"Viral_Load"]
herv_table_cd4a$viral_load[is.na(herv_table_cd4a$viral_load)] <- 0
herv_table_cd4a$cd4_T_Cells_per_gram <- meta[rownames(herv_table_cd4a),"CD4.T.Cells.g"]
herv_table_cd4a$cd8_T_Cells_per_gram <- meta[rownames(herv_table_cd4a),"CD8.T.cells.g"]
herv_table_cd4a$IFNYposIL17neg_CD4_T_Cells_per_gram <- meta[rownames(herv_table_cd4a),"IFNg.IL17..CD4.T.Cells.g"]
herv_table_cd4a$IFNYnegIL17pos_CD4_T_Cells_per_gram <- meta[rownames(herv_table_cd4a),"IFNg.IL17..CD4.T.Cells.g.1"]
herv_table_cd4a$IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram  <- meta[rownames(herv_table_cd4a),"IL22.IFNg.IL17..CD4.T.Cells.g"]
herv_table_cd4a$IFNYposIL17pos_CD4_T_Cells_per_gram  <- meta[rownames(herv_table_cd4a),"IFNg.IL17..CD4.T.Cells.g.2"]
herv_table_cd4a$IFNYpos_cd8_T_Cells_per_gram <- meta[rownames(herv_table_cd4a),"IFNg.CD8.T.Cells.g"]
herv_table_cd4a$pDCs_per_gram <- meta[rownames(herv_table_cd4a),"pDCs.g"]
herv_table_cd4a$CD11cpos_mDCs_per_gram <- meta[rownames(herv_table_cd4a),"CD11c..mDC.g"]
herv_table_cd4a$CD1cpos_mDCs_per_gram <- meta[rownames(herv_table_cd4a),"CD1c..mDC.g"]
herv_table_cd4a$CD1cneg_mDCs_per_gram <- meta[rownames(herv_table_cd4a),"CD1c..mDC.g.1"]
herv_table_cd4a$IL6 <- meta[rownames(herv_table_cd4a),"IL6"]
herv_table_cd4a$LPS <- meta[rownames(herv_table_cd4a),"LPS"]

#Remove samples per clinical parameter that do not have clinical parameter collected
herv_table_cd4a_CD4_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$cd4_T_Cells_per_gram)),]

herv_table_cd4a_CD8_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$cd8_T_Cells_per_gram)),]

herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IFNYposIL17neg_CD4_T_Cells_per_gram)),]

herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IFNYnegIL17pos_CD4_T_Cells_per_gram)),]

herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram)),]

herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IFNYposIL17pos_CD4_T_Cells_per_gram)),]

herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IFNYpos_cd8_T_Cells_per_gram)),]

herv_table_cd4a_pDCs_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$pDCs_per_gram)),]

herv_table_cd4a_CD11cpos_mDCs_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$CD11cpos_mDCs_per_gram)),]

herv_table_cd4a_CD1cpos_mDCs_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$CD1cpos_mDCs_per_gram)),]

herv_table_cd4a_CD1cneg_mDCs_per_gram_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$CD1cneg_mDCs_per_gram)),]

herv_table_cd4a_IL6_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$IL6)),]

herv_table_cd4a_LPS_sub <- herv_table_cd4a[which(!is.na(herv_table_cd4a$LPS)),]

```




```{r}
#Annoying, but have to change all these to numeric for some reason? Changing the table as a whole to numeric did not work (for me)
# "L1FLnI_4q35.2i"    "L1FLnI_4p16.3c"    "L1FLnI_1p13.1e"    "L1FLnI_1p34.2a"    "L1FLnI_1p22.2l"    "MER4_7q21.2"      "LTR19_12p13.31"    "MER4B_19q13.42a"   "MER101_2p25.2"     "L1FLnI_17q12k"     "L1FLnI_1q23.1t"    "HERVH_6q23.1"     "L1FLnI_1q23.1u"    "HERVIP10F_12p13.2" "HARLEQUIN_10q24.2" "HERVH48_2q22.2"    "HERVH_4p15.33d"    "HARLEQUIN_17q12"  "L1FLnI_4p15.32e"   "L1FLnI_3p24.1m"    "MER61_1q23.1c"     "L1FLnI_Xq21.1hb"   "L1FLnI_2q22.2k"    "L1FLnI_12p13.31k"  "HERVEA_5q22.2"     "HERVH_7q11.21"     "L1FLnI_12p12.1r"   "L1FLnI_1q23.2i"    "L1FLnI_7p13a"      "ERVLB4_17q25.3b"  "L1FLnI_16q12.1b"   "MER34B_4q31.3"     "HERV4_4q22.1"      "HERVH_2q24.1e"     "HARLEQUIN_10q23.1" "MER41_16q21"      "L1FLnI_1q23.1s"    "HERV3_7q33"        "L1FLnI_18q12.3x"   "L1FLnI_11q13.4d"   "L1FLnI_2q33.1g"    "HARLEQUIN_7q33a"  "L1FLnI_1q23.3b"    "L1FLnI_Xq21.1db"   "L1FLnI_9p21.1ha"   "L1FLnI_5q32n"      "L1FLnI_5q32o"      "L1FLnI_8q21.3da"  "L1FLnI_7q31.1ta"   "L1FLnI_3q26.31h"   "L1FLnI_1p31.1nc"   "L1FLnI_4p13m"      "L1FLnI_6q22.31z"   "L1FLnI_7q21.13c"  "L1FLnI_11p14.1v"   "L1FLnI_4q21.21x"   "L1FLnI_5q21.3q"    "L1FLnI_1p31.1l"    "L1FLnI_2q32.1k"

herv_table_cd4a$L1FLnI_4q35.2i <- as.numeric(herv_table_cd4a$L1FLnI_4q35.2i)
  pdf("L1FLnI_4q35.2i CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_4q35.2i, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_4q35.2i Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_4q35.2i, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_4p16.3c <- as.numeric(herv_table_cd4a$L1FLnI_4p16.3c)
  pdf("L1FLnI_4p16.3c CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_4p16.3c, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_4p16.3c Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_4p16.3c, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1p13.1e <- as.numeric(herv_table_cd4a$L1FLnI_1p13.1e)
  pdf("L1FLnI_1p13.1e CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1p13.1e, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1p13.1e Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1p13.1e, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1p34.2a <- as.numeric(herv_table_cd4a$L1FLnI_1p34.2a)
  pdf("L1FLnI_1p34.2a CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1p34.2a, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1p34.2a Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1p34.2a, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1p22.2l <- as.numeric(herv_table_cd4a$L1FLnI_1p22.2l)
  pdf("L1FLnI_1p22.2l CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1p22.2l, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1p22.2l Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1p22.2l, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER4_7q21.2 <- as.numeric(herv_table_cd4a$MER4_7q21.2)
  pdf("MER4_7q21.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER4_7q21.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER4_7q21.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER4_7q21.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$LTR19_12p13.31 <- as.numeric(herv_table_cd4a$LTR19_12p13.31)
  pdf("LTR19_12p13.31 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
  dev.off()
  pdf("LTR19_12p13.31 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER4B_19q13.42a <- as.numeric(herv_table_cd4a$MER4B_19q13.42a)
  pdf("MER4B_19q13.42a CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER4B_19q13.42a, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER4B_19q13.42a Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER4B_19q13.42a, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER101_2p25.2 <- as.numeric(herv_table_cd4a$MER101_2p25.2)
  pdf("MER101_2p25.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER101_2p25.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER101_2p25.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER101_2p25.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_17q12k <- as.numeric(herv_table_cd4a$L1FLnI_17q12k)
  pdf("L1FLnI_17q12k CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_17q12k, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_17q12k Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_17q12k, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1q23.1t <- as.numeric(herv_table_cd4a$L1FLnI_1q23.1t)
  pdf("L1FLnI_1q23.1t CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1q23.1t, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1q23.1t Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1q23.1t, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVH_6q23.1 <- as.numeric(herv_table_cd4a$HERVH_6q23.1)
  pdf("HERVH_6q23.1 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVH_6q23.1, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVH_6q23.1 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVH_6q23.1, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1q23.1u <- as.numeric(herv_table_cd4a$L1FLnI_1q23.1u)
  pdf("L1FLnI_1q23.1u CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1q23.1u, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1q23.1u Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1q23.1u, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVIP10F_12p13.2 <- as.numeric(herv_table_cd4a$HERVIP10F_12p13.2)
  pdf("HERVIP10F_12p13.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVIP10F_12p13.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVIP10F_12p13.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVIP10F_12p13.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HARLEQUIN_10q24.2 <- as.numeric(herv_table_cd4a$HARLEQUIN_10q24.2)
  pdf("HARLEQUIN_10q24.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HARLEQUIN_10q24.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HARLEQUIN_10q24.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HARLEQUIN_10q24.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVH48_2q22.2 <- as.numeric(herv_table_cd4a$HERVH48_2q22.2)
  pdf("HERVH48_2q22.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVH48_2q22.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVH48_2q22.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVH48_2q22.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVH_4p15.33d <- as.numeric(herv_table_cd4a$HERVH_4p15.33d)
  pdf("HERVH_4p15.33d CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVH_4p15.33d, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVH_4p15.33d Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVH_4p15.33d, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HARLEQUIN_17q12 <- as.numeric(herv_table_cd4a$HARLEQUIN_17q12)
  pdf("HARLEQUIN_17q12 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HARLEQUIN_17q12, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HARLEQUIN_17q12 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HARLEQUIN_17q12, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_4p15.32e <- as.numeric(herv_table_cd4a$L1FLnI_4p15.32e)
  pdf("L1FLnI_4p15.32e CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_4p15.32e, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_4p15.32e Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_4p15.32e, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_3p24.1m <- as.numeric(herv_table_cd4a$L1FLnI_3p24.1m)
  pdf("L1FLnI_3p24.1m CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_3p24.1m, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_3p24.1m Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_3p24.1m, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER61_1q23.1c <- as.numeric(herv_table_cd4a$MER61_1q23.1c)
  pdf("MER61_1q23.1c CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER61_1q23.1c, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER61_1q23.1c Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER61_1q23.1c, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_Xq21.1hb <- as.numeric(herv_table_cd4a$L1FLnI_Xq21.1hb)
  pdf("L1FLnI_Xq21.1hb CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_Xq21.1hb, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_Xq21.1hb Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_Xq21.1hb, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_2q22.2k <- as.numeric(herv_table_cd4a$L1FLnI_2q22.2k)
  pdf("L1FLnI_2q22.2k CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_2q22.2k, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_2q22.2k Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_2q22.2k, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_12p13.31k <- as.numeric(herv_table_cd4a$L1FLnI_12p13.31k)
  pdf("L1FLnI_12p13.31k CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_12p13.31k, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_12p13.31k Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_12p13.31k, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVEA_5q22.2 <- as.numeric(herv_table_cd4a$HERVEA_5q22.2)
  pdf("HERVEA_5q22.2 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVEA_5q22.2, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVEA_5q22.2 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVEA_5q22.2, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVH_7q11.21 <- as.numeric(herv_table_cd4a$HERVH_7q11.21)
  pdf("HERVH_7q11.21 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVH_7q11.21, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVH_7q11.21 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVH_7q11.21, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_12p12.1r <- as.numeric(herv_table_cd4a$L1FLnI_12p12.1r)
  pdf("L1FLnI_12p12.1r CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_12p12.1r, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_12p12.1r Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_12p12.1r, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1q23.2i <- as.numeric(herv_table_cd4a$L1FLnI_1q23.2i)
  pdf("L1FLnI_1q23.2i CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1q23.2i, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1q23.2i Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1q23.2i, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_7p13a <- as.numeric(herv_table_cd4a$L1FLnI_7p13a)
  pdf("L1FLnI_7p13a CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_7p13a, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_7p13a Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_7p13a, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$ERVLB4_17q25.3b <- as.numeric(herv_table_cd4a$ERVLB4_17q25.3b)
  pdf("ERVLB4_17q25.3b CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = ERVLB4_17q25.3b, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("ERVLB4_17q25.3b Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = ERVLB4_17q25.3b, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_16q12.1b <- as.numeric(herv_table_cd4a$L1FLnI_16q12.1b)
  pdf("L1FLnI_16q12.1b CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_16q12.1b, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_16q12.1b Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_16q12.1b, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER34B_4q31.3 <- as.numeric(herv_table_cd4a$MER34B_4q31.3)
  pdf("MER34B_4q31.3 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER34B_4q31.3, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER34B_4q31.3 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER34B_4q31.3, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERV4_4q22.1 <- as.numeric(herv_table_cd4a$HERV4_4q22.1)
  pdf("HERV4_4q22.1 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERV4_4q22.1, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERV4_4q22.1 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERV4_4q22.1, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERVH_2q24.1e <- as.numeric(herv_table_cd4a$HERVH_2q24.1e)
  pdf("HERVH_2q24.1e CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERVH_2q24.1e, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERVH_2q24.1e Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERVH_2q24.1e, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HARLEQUIN_10q23.1 <- as.numeric(herv_table_cd4a$HARLEQUIN_10q23.1)
  pdf("HARLEQUIN_10q23.1 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HARLEQUIN_10q23.1, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)  + xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HARLEQUIN_10q23.1 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HARLEQUIN_10q23.1, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$MER41_16q21 <- as.numeric(herv_table_cd4a$MER41_16q21)
  pdf("MER41_16q21 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = MER41_16q21, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("MER41_16q21 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = MER41_16q21, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a$L1FLnI_1q23.1s)
  pdf("L1FLnI_1q23.1s CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1q23.1s Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HERV3_7q33 <- as.numeric(herv_table_cd4a$HERV3_7q33)
  pdf("HERV3_7q33 CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HERV3_7q33, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HERV3_7q33 Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HERV3_7q33, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_18q12.3x <- as.numeric(herv_table_cd4a$L1FLnI_18q12.3x)
  pdf("L1FLnI_18q12.3x CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_18q12.3x, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_18q12.3x Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_18q12.3x, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_11q13.4d <- as.numeric(herv_table_cd4a$L1FLnI_11q13.4d)
  pdf("L1FLnI_11q13.4d CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_11q13.4d, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_11q13.4d Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_11q13.4d, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_2q33.1g <- as.numeric(herv_table_cd4a$L1FLnI_2q33.1g)
  pdf("L1FLnI_2q33.1g CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_2q33.1g, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_2q33.1g Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_2q33.1g, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$HARLEQUIN_7q33a <- as.numeric(herv_table_cd4a$HARLEQUIN_7q33a)
  pdf("HARLEQUIN_7q33a CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = HARLEQUIN_7q33a, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("HARLEQUIN_7q33a Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = HARLEQUIN_7q33a, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1q23.3b <- as.numeric(herv_table_cd4a$L1FLnI_1q23.3b)
  pdf("L1FLnI_1q23.3b CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1q23.3b, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1q23.3b Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1q23.3b, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_Xq21.1db <- as.numeric(herv_table_cd4a$L1FLnI_Xq21.1db)
  pdf("L1FLnI_Xq21.1db CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_Xq21.1db, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_Xq21.1db Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_Xq21.1db, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_9p21.1ha <- as.numeric(herv_table_cd4a$L1FLnI_9p21.1ha)
  pdf("L1FLnI_9p21.1ha CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_9p21.1ha, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_9p21.1ha Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_9p21.1ha, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_5q32n <- as.numeric(herv_table_cd4a$L1FLnI_5q32n)
  pdf("L1FLnI_5q32n CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_5q32n, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_5q32n Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_5q32n, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_5q32o <- as.numeric(herv_table_cd4a$L1FLnI_5q32o)
  pdf("L1FLnI_5q32o CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_5q32o Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_8q21.3da <- as.numeric(herv_table_cd4a$L1FLnI_8q21.3da)
  pdf("L1FLnI_8q21.3da CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_8q21.3da, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_8q21.3da Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_8q21.3da, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_7q31.1ta <- as.numeric(herv_table_cd4a$L1FLnI_7q31.1ta)
  pdf("L1FLnI_7q31.1ta CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_7q31.1ta, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_7q31.1ta Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_7q31.1ta, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_3q26.31h <- as.numeric(herv_table_cd4a$L1FLnI_3q26.31h)
  pdf("L1FLnI_3q26.31h CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_3q26.31h, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_3q26.31h Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_3q26.31h, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1p31.1nc <- as.numeric(herv_table_cd4a$L1FLnI_1p31.1nc)
  pdf("L1FLnI_1p31.1nc CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1p31.1nc, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl")+ stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1p31.1nc Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1p31.1nc, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_4p13m <- as.numeric(herv_table_cd4a$L1FLnI_4p13m)
  pdf("L1FLnI_4p13m CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_4p13m, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_4p13m Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_4p13m, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_6q22.31z <- as.numeric(herv_table_cd4a$L1FLnI_6q22.31z)
  pdf("L1FLnI_6q22.31z CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_6q22.31z, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_6q22.31z Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_6q22.31z, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_7q21.13c <- as.numeric(herv_table_cd4a$L1FLnI_7q21.13c)
  pdf("L1FLnI_7q21.13c CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_7q21.13c, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_7q21.13c Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_7q21.13c, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_11p14.1v <- as.numeric(herv_table_cd4a$L1FLnI_11p14.1v)
  pdf("L1FLnI_11p14.1v CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_11p14.1v, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_11p14.1v Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_11p14.1v, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_11p14.1v <- as.numeric(herv_table_cd4a$L1FLnI_11p14.1v)
  pdf("L1FLnI_11p14.1v CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_11p14.1v, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_11p14.1v Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_11p14.1v, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_4q21.21x <- as.numeric(herv_table_cd4a$L1FLnI_4q21.21x)
  pdf("L1FLnI_4q21.21x CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_4q21.21x, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_4q21.21x Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_4q21.21x, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_5q21.3q <- as.numeric(herv_table_cd4a$L1FLnI_5q21.3q)
  pdf("L1FLnI_5q21.3q CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_5q21.3q, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_5q21.3q Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_5q21.3q, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_2q32.1k <- as.numeric(herv_table_cd4a$L1FLnI_2q32.1k)
  pdf("CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_2q32.1k, col = disease )) + geom_point() + theme_bw()  + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_2q32.1k Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_2q32.1k, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
herv_table_cd4a$L1FLnI_1p31.1l <- as.numeric(herv_table_cd4a$L1FLnI_1p31.1l)
  pdf("CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=CD4a, y = L1FLnI_1p31.1l, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)+ xlab("CD4+ Cells/μl") + stat_cor(method = "pearson")
    dev.off()
  pdf("L1FLnI_1p31.1l Viral Load.pdf")
  ggplot(herv_table_cd4a, aes(x=viral_load, y = L1FLnI_1p31.1l, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("HIV-1 Copies/mL") + stat_cor(method = "pearson")
    dev.off()
```

#3 TEs of further interest
#TEs in which Pearson correlation for viral load possesses p value <0.1 and is reversal of the healthy control samples
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

#Gut CD4 T Cell Counts
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s
    #cd4a = blood CD4 counts, cd4=gut CD4 counts
pdf("L1FLnI_5q32o Gut CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=cd4, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Percent of CD45+ Cells") + stat_cor(method = "pearson")
    dev.off()
pdf("LTR19_12p13.31 Gut CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=cd4, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Percent of CD45+ Cells") + stat_cor(method = "pearson")
    dev.off()
pdf("L1FLnI_1q23.1s Gut CD4 Counts.pdf")
  ggplot(herv_table_cd4a, aes(x=cd4, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Percent of CD45+ Cells") + stat_cor(method = "pearson")
    dev.off()
```

#CD11c+ mDCs per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut CD11c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub, aes(x=CD11cpos_mDCs_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD11c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut CD11c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub, aes(x=CD11cpos_mDCs_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD11c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut CD11c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD11cpos_mDCs_per_gram_sub, aes(x=CD11cpos_mDCs_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD11c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
 
```

#CD1c- mDCs per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut CD1c- mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub, aes(x=CD1cneg_mDCs_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c- mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut CD1c- mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub, aes(x=CD1cneg_mDCs_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c- mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut CD1c- mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cneg_mDCs_per_gram_sub, aes(x=CD1cneg_mDCs_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c- mDCs per gram (colon)") + stat_cor(method = "pearson")
```


#CD1c+ mDCs per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut CD1c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub, aes(x=CD1cpos_mDCs_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut CD1c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub, aes(x=CD1cpos_mDCs_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut CD1c+ mDCs per gram.pdf")
  ggplot(herv_table_cd4a_CD1cpos_mDCs_per_gram_sub, aes(x=CD1cpos_mDCs_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD1c+ mDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
  
```


#Gut CD4+T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD4_T_Cells_per_gram_sub, aes(x=cd4_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD4_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_CD4_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD4_T_Cells_per_gram_sub, aes(x=cd4_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD4_T_Cells_per_gram_sub, aes(x=cd4_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
```

#Gut CD8+T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_CD8_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_CD8_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD8_T_Cells_per_gram_sub, aes(x=cd8_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD8_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_CD8_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD8_T_Cells_per_gram_sub, aes(x=cd8_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_CD8_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_CD8_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_CD8_T_Cells_per_gram_sub, aes(x=cd8_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
  
```


#Gut IFNy-IL17+T CD4+ T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut IFNy-IL17+T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYnegIL17pos_CD4_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy-IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut IFNy-IL17+T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYnegIL17pos_CD4_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Gut IFNy-IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut IFNy-IL17+T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYnegIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYnegIL17pos_CD4_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Gut IFNy-IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
```

#Gut IFNy+ CD8+T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut IFNy+ CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub, aes(x=IFNYpos_cd8_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+ CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut IFNy+ CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub, aes(x=IFNYpos_cd8_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+ CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut IFNy+ CD8+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYpos_cd8_T_Cells_per_gram_sub, aes(x=IFNYpos_cd8_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+ CD8+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
```

#Gut IFNy+IL17-T CD4+ T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut IFNy+IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17neg_CD4_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut IFNy+IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17neg_CD4_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut IFNy+IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17neg_CD4_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
```

#Gut IFNy+IL17+T CD4+ T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut IFNy+IL17+ T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17pos_CD4_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut IFNy+IL17+ T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17pos_CD4_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut IFNy+IL17+ T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IFNYposIL17pos_CD4_T_Cells_per_gram_sub, aes(x=IFNYposIL17pos_CD4_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IFNy+IL17+T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
```

#Gut IL22+IFNy-IL17- T CD4+ T Cells per gram
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut IL22+IFNy-IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IL22+IFNy-IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut IL22+IFNy-IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IL22+IFNy-IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut IL22+IFNy-IL17-T CD4+ T Cells per gram.pdf")
  ggplot(herv_table_cd4a_IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram_sub, aes(x=IL22posIFNYnegIL17neg_CD4_T_Cells_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("IL22+IFNy-IL17-T CD4+ T Cells per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
```


#Serum IL-6
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_IL6_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_IL6_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Serum IL-6.pdf")
  ggplot(herv_table_cd4a_IL6_sub, aes(x=IL6, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum IL-6") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IL6_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_IL6_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Serum IL-6.pdf")
  ggplot(herv_table_cd4a_IL6_sub, aes(x=IL6, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum IL-6") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_IL6_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_IL6_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Serum IL-6.pdf")
  ggplot(herv_table_cd4a_IL6_sub, aes(x=IL6, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum IL-6") + stat_cor(method = "pearson")
    dev.off()
```

#Serum LPS
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_LPS_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_LPS_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Serum LPS.pdf")
  ggplot(herv_table_cd4a_LPS_sub, aes(x=LPS, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum LPS") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_LPS_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_LPS_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Serum LPS.pdf")
  ggplot(herv_table_cd4a_LPS_sub, aes(x=LPS, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum LPS") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_LPS_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_LPS_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Serum LPS.pdf")
  ggplot(herv_table_cd4a_LPS_sub, aes(x=LPS, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("Serum LPS") + stat_cor(method = "pearson")
    dev.off()
```

#pDCs per gram (colon)
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s

herv_table_cd4a_pDCs_per_gram_sub$L1FLnI_5q32o <- as.numeric(herv_table_cd4a_pDCs_per_gram_sub$L1FLnI_5q32o)
pdf("L1FLnI_5q32o Gut pDCs per gram.pdf")
  ggplot(herv_table_cd4a_pDCs_per_gram_sub, aes(x=pDCs_per_gram, y = L1FLnI_5q32o, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("pDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_pDCs_per_gram_sub$LTR19_12p13.31 <- as.numeric(herv_table_cd4a_pDCs_per_gram_sub$LTR19_12p13.31)
pdf("LTR19_12p13.31 Gut pDCs per gram.pdf")
  ggplot(herv_table_cd4a_pDCs_per_gram_sub, aes(x=pDCs_per_gram, y = LTR19_12p13.31, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("pDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
    
herv_table_cd4a_pDCs_per_gram_sub$L1FLnI_1q23.1s <- as.numeric(herv_table_cd4a_pDCs_per_gram_sub$L1FLnI_1q23.1s)
pdf("L1FLnI_1q23.1s Gut pDCs per gram.pdf")
  ggplot(herv_table_cd4a_pDCs_per_gram_sub, aes(x=pDCs_per_gram, y = L1FLnI_1q23.1s, col = disease )) + geom_point() + theme_bw() + geom_smooth(method=lm)  + xlab("pDCs per gram (colon)") + stat_cor(method = "pearson")
    dev.off()
```

#Bar Charts L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s
```{r}
#L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s
#Gut Data
pdf("Gut_L1FLnI_5q32o.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_5q32o", title = "L1FLnI_5q32o")

dev.off()

pdf("Gut_LTR19_12p13.31.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "LTR19_12p13.31", title = "LTR19_12p13.31")

dev.off()

pdf("Gut_L1FLnI_1q23.1s.pdf", height = 6, width = 4)

plot_contrast(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1q23.1s", title = "L1FLnI_1q23.1s")

dev.off()

#Interferome Data
pdf("L1FLnI_5q32o.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_5q32o", title = "L1FLnI_5q32o", group = "multiple")

dev.off()

pdf("LTR19_12p13.31.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "LTR19_12p13.31", title = "LTR19_12p13.31", group = "multiple")

dev.off()

pdf("L1FLnI_1q23.1s.pdf", height = 6, width = 5)

plot_contrast(dfSigIntMat, metadata = meta_int, category = "Library.Name", herv = "L1FLnI_1q23.1s", title = "L1FLnI_1q23.1s", group = "multiple")

dev.off()
```

##PBMC Data
```{r}
##Set to personal directory
setwd("D:\\Nixon Lab/HERV Gut - interferome Mario Paper/RDirectory/HIV_HERV/")
###########Scopetools##################################
####Create a list of sample names

sam_names_dir_PBMC <- gsub(paste("pbmc/telescope/","\\/",sep = ""),"",list.dirs("pbmc/telescope/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv_PBMC <- load_telescope_reports(files = paste("pbmc/telescope/",sam_names_dir_PBMC,"/",sam_names_dir_PBMC,".tsv", sep = ""), colnames = sam_names_dir_PBMC)


##filter lowly abundant retrotransposons
cutoff.count <- 2
cutoff.sample <- floor(ncol(raw_herv_PBMC) * 0.1)
raw_herv_PBMC <- raw_herv_PBMC[rowSums(raw_herv_PBMC > cutoff.count) > cutoff.sample, ]
raw_herv_PBMC <- raw_herv_PBMC[!(row.names(raw_herv_PBMC) %in% "__no_feature"),]
```

#DESEQ PBMCs
```{r}
ddsfPBMCFormat <- ddsf
rownames(ddsfPBMCFormat) <- ddsfPBMCFormat$MIHIVode
ddsPBMC <- DESeqDataSetFromMatrix(countData = raw_herv_PBMC, colData = ddsfPBMCFormat[colnames(raw_herv_PBMC),], design = ~ disease)
ddsPBMC$disease <- relevel(ddsPBMC$disease, ref = "HIVneg")
ddsPBMC <- DESeq(ddsPBMC)
resultsNames(ddsPBMC)
resultsddsPBMC <- results(ddsPBMC, name = "disease_HIVpos_vs_HIVneg")
```

##Make Volcano Plot PBMCs
```{r}
pdf("HIV+ vs HIV- PBMCs.pdf")

keyvals.colourPBMC <- ifelse(
    resultsddsPBMC$padj > 0.05, 'black',
      ifelse(resultsddsPBMC$log2FoldChange > 1, '#063970',ifelse(
             resultsddsPBMC$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.colourPBMC[is.na(keyvals.colourPBMC)] <- 'black'
  names(keyvals.colourPBMC)[keyvals.colourPBMC == '#063970'] <- 'Upregulated'
  names(keyvals.colourPBMC)[keyvals.colourPBMC == 'black'] <- 'Unchanged'
  names(keyvals.colourPBMC)[keyvals.colourPBMC == '#Ff6300'] <- 'Downregulated'

EnhancedVolcano::EnhancedVolcano(resultsddsPBMC, lab = rownames(resultsddsPBMC), x = 'log2FoldChange', y = 'padj', title = 'HIVneg vs HIVpos PBMCs', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.colourPBMC)

dev.off()
```

##Make PCA PBMCs

```{r}
vstPBMC <- assay(vst(ddsPBMC))
pPBMC <- pca(vstPBMC, metadata = colData(ddsPBMC), removeVar = 0.1)

pdf("SCREE plot PBMC.pdf")
screeplot(pPBMC, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot PBMC.pdf")
biplot(pPBMC, lab = pPBMC$disease, labSize = 2, pointSize = 2, colby = 'disease', shape = 'Sex', legendTitleSize = 0, showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-60,60), title = 'HIVneg vs HIVpos PBMC') 

dev.off()
```


##PLot_contrast +T Test
```{r}
plot_contrast_STAT <- function(count_table, metadata,category, herv, title = "Selected Counts", group = "2-side"){
  count_hervs <- cbind(t(count_table[herv,rownames(metadata), drop = FALSE]), metadata[, category,drop = FALSE])
  colnames(count_hervs) <- c("HERV","Category")
  if(group == "2-side"){
  herv_plot <- ggplot(count_hervs, aes(x = Category, y = HERV, color = Category)) +stat_compare_means(method = "t.test") + geom_boxplot(outlier.shape = NA)+ geom_jitter(size = 1, shape=16, position=position_jitter(0.2))+ stat_summary(fun.y=mean)+xlab(NULL)+ ylab(" Normalized Counts")+ggtitle(title)+theme(plot.title = element_text(size = 15, face = "bold"),axis.title=element_text(size=15,face="bold"),legend.title = element_text(size = 15,face="bold"),axis.text = element_text(size = 15),axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+ theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))}
  else{
    herv_plot <- ggplot(count_hervs, aes(x = Category, y = HERV, color = Category)) + geom_boxplot(outlier.shape = NA)+ geom_jitter(size = 1, shape=16, position=position_jitter(0.2))+ stat_summary(fun.y=mean)+xlab(NULL)+ ylab(" Normalized Counts")+ggtitle(title)+theme(plot.title = element_text(size = 15, face = "bold"),axis.title=element_text(size=15,face="bold"),legend.title = element_text(size = 15,face="bold"),axis.text = element_text(size = 15),axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+ theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
  }
  return(print(herv_plot))}
```


```{r}
dtMat_PBMC <- counts(ddsPBMC, normalized = TRUE)
### L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s 

pdf("PBMC_L1FLnI_5q32o.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat_PBMC, metadata = ddsfPBMCFormat, category = "disease", herv = "L1FLnI_5q32o", title = "L1FLnI_5q32o")

dev.off()

pdf("PBMC_LTR19_12p13.31.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat_PBMC, metadata = ddsfPBMCFormat, category = "disease", herv = "LTR19_12p13.31", title = "LTR19_12p13.31")

dev.off()

pdf("PBMC_L1FLnI_1q23.1s.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat_PBMC, metadata = ddsfPBMCFormat, category = "disease", herv = "L1FLnI_1q23.1s", title = "L1FLnI_1q23.1s")

dev.off()


pdf("Gut_L1FLnI_5q32o.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_5q32o", title = "L1FLnI_5q32o")

dev.off()

pdf("Gut_LTR19_12p13.31.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat, metadata = meta, category = "disease", herv = "LTR19_12p13.31", title = "LTR19_12p13.31")

dev.off()

pdf("Gut_L1FLnI_1q23.1s.pdf", height = 6, width = 4)

plot_contrast_STAT(dtMat, metadata = meta, category = "disease", herv = "L1FLnI_1q23.1s", title = "L1FLnI_1q23.1s")

dev.off()
```

















##VDZ data

```{r}
####Create a list of sample names
sam_names_dir_VDZ <- gsub(paste("HOPE_HIV/telescope/","\\/",sep = ""),"",list.dirs("HOPE_HIV/telescope/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv_VDZ <- load_telescope_reports(files = paste("HOPE_HIV/telescope/", sam_names_dir_VDZ,"/",sam_names_dir_VDZ,".tsv", sep = ""), colnames = sam_names_dir_VDZ)

##filter lowly abundant retrotransposons
cutoff.count <- 1
cutoff.sample <- floor(ncol(raw_herv_VDZ) * 0.05)
raw_herv_VDZ <- raw_herv_VDZ[rowSums(raw_herv_VDZ > cutoff.count) > cutoff.sample, ]
raw_herv_VDZ <- raw_herv_VDZ[!(row.names(raw_herv_VDZ) %in% "__no_feature"),]
```


##DESEQ2 VDZ

```{r}
ddsf_VDZ <- read.csv(file = "HOPEmeta.csv")
rownames(ddsf_VDZ) <- ddsf_VDZ$ï..Sample
dds_VDZ <- DESeqDataSetFromMatrix(countData = raw_herv_VDZ[, rownames(ddsf_VDZ)], colData = ddsf_VDZ, design = ~ Condition)
dds_VDZ <- DESeq(dds_VDZ, parallel = T, betaPrior = T)
resultsNames(dds_VDZ)

##"ConditionLC_POST" "ConditionLC_PRE"  "ConditionTI_POST" "ConditionTI_PRE" 
```

##Make Volcano Plot Library.Name_LC_PRE vs LC_POST

```{r}
#Null , xlim = c(, ), ylim = c(,) can be added for preference

resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE <- results(dds_VDZ, contrast=c("Condition", "LC_POST", "LC_PRE"))

keyvals.coloura1 <- ifelse(
    resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE$padj > 0.05, 'black',
      ifelse(resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura1[is.na(keyvals.coloura1)] <- 'black'
  names(keyvals.coloura1)[keyvals.coloura1 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == 'black'] <- 'Unregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == '#Ff6300'] <- 'Downregulated'
  
pdf("Condition LC Pre vs Post.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE, lab = rownames(resultsdds_VDZ_Condition_LC_POST_vs_LC_PRE), x = 'log2FoldChange', y = 'padj', title = 'Left Colon VDZ Treatment', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura1)

dev.off()
```

##Make Volcano Plot Library.Name_TI_PRE vs TI_POST

```{r}
#Null , xlim = c(, ), ylim = c(,) can be added for preference

resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE <- results(dds_VDZ, contrast=c("Condition", "TI_POST", "TI_PRE"))

keyvals.coloura1 <- ifelse(
    resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE$padj > 0.05, 'black',
      ifelse(resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura1[is.na(keyvals.coloura1)] <- 'black'
  names(keyvals.coloura1)[keyvals.coloura1 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == 'black'] <- 'Unregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == '#Ff6300'] <- 'Downregulated'
  
pdf("Condition TI Pre vs Post.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE, lab = rownames(resultsdds_VDZ_Condition_TI_POST_vs_TI_PRE), x = 'log2FoldChange', y = 'padj', title = 'Terminal Ileum VDZ Treatment', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura1)

dev.off()
```

##Make Volcano Plot Library.Name_TI_PRE vs LC_POST

```{r}
#Null , xlim = c(, ), ylim = c(,) can be added for preference

resultsdds_VDZ_Condition_TI_PREvs_LC_PRE <- results(dds_VDZ, contrast=c("Condition", "TI_PRE", "LC_PRE"))

keyvals.coloura1 <- ifelse(
    resultsdds_VDZ_Condition_TI_PREvs_LC_PRE$padj > 0.05, 'black',
      ifelse(resultsdds_VDZ_Condition_TI_PREvs_LC_PRE$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_VDZ_Condition_TI_PREvs_LC_PRE$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura1[is.na(keyvals.coloura1)] <- 'black'
  names(keyvals.coloura1)[keyvals.coloura1 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == 'black'] <- 'Unregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == '#Ff6300'] <- 'Downregulated'
  
pdf("Pretreatment TI vs LC.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_VDZ_Condition_TI_PREvs_LC_PRE, lab = rownames(resultsdds_VDZ_Condition_TI_PREvs_LC_PRE), x = 'log2FoldChange', y = 'padj', title = 'Pre treatment LC vs TI', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura1)

dev.off()
```


##Make Volcano Plot Library.Name_TI_POST vs LC_POST

```{r}
#Null , xlim = c(, ), ylim = c(,) can be added for preference

resultsdds_VDZ_Condition_TI_POSTvs_LC_POST <- results(dds_VDZ, contrast=c("Condition", "TI_POST", "LC_POST"))

keyvals.coloura1 <- ifelse(
    resultsdds_VDZ_Condition_TI_POSTvs_LC_POST$padj > 0.05, 'black',
      ifelse(resultsdds_VDZ_Condition_TI_POSTvs_LC_POST$log2FoldChange > 1, '#063970',ifelse(
             resultsdds_VDZ_Condition_TI_POSTvs_LC_POST$log2FoldChange < -1, '#Ff6300',
        'black')))
  keyvals.coloura1[is.na(keyvals.coloura1)] <- 'black'
  names(keyvals.coloura1)[keyvals.coloura1 == '#063970'] <- 'Upregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == 'black'] <- 'Unregulated'
  names(keyvals.coloura1)[keyvals.coloura1 == '#Ff6300'] <- 'Downregulated'
  
pdf("Post treatment TI vs LC.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_VDZ_Condition_TI_POSTvs_LC_POST, lab = rownames(resultsdds_VDZ_Condition_TI_POSTvs_LC_POST), x = 'log2FoldChange', y = 'padj', title = 'Posttreatment LC vs TI', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', colCustom = keyvals.coloura1)

dev.off()
```



```{r}
#Gut Sample Matrix
dtMat_VDZ <- counts(dds_VDZ, normalized = TRUE)
### L1FLnI_5q32o, LTR19_12p13.31, L1FLnI_1q23.1s 

pdf("VDZ_L1FLnI_5q32o.pdf", height = 6, width = 4)

plot_contrast(dtMat_VDZ, metadata = ddsf_VDZ, category = "Condition", herv = "L1FLnI_5q32o", title = "L1FLnI_5q32o")

dev.off()

pdf("VDZ_LTR19_12p13.31.pdf", height = 6, width = 4)

plot_contrast(dtMat_VDZ, metadata = ddsf_VDZ, category = "Condition", herv = "LTR19_12p13.31", title = "LTR19_12p13.31")

dev.off()

pdf("VDZ_L1FLnI_1q23.1s.pdf", height = 6, width = 4)

plot_contrast(dtMat_VDZ, metadata = ddsf_VDZ, category = "Condition", herv = "L1FLnI_1q23.1s", title = "L1FLnI_1q23.1s")

dev.off()
```


```{r}
vstVDZ <- assay(vst(dds_VDZ))
pVDZ <- pca(vstVDZ, metadata = colData(dds_VDZ), removeVar = 0.1)

pdf("SCREE plot VDZ.pdf")
screeplot(pVDZ, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot_VDZ.pdf")
biplot(pVDZ, lab = pVDZ$Condition, labSize = 2, pointSize = 2, colby = 'Condition', shape = 'Individual', legendTitleSize = 0, showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-60,60), title = 'VDZ Treatment') 

dev.off()
```


