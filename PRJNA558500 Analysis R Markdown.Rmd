---
title: "HIV_HERV"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



## load packages
```{r}
library(tidyverse)
library(data.table)
library(PCAtools)
library(dplyr)
library(matrixStats)
library(edgeR)
library(DESeq2)
library(EnhancedVolcano)
library(ashr)
library(cowplot)
library(ggsci)
library(ggplot2)
library(ggpubr)
library(fgsea)
library(pheatmap)
library(scales)
library(scopetools)
library(pheatmap)
```

##Gut Biopses
```{r}
setwd("D:\\Nixon Lab/HERV Gut - interferome Mario Paper/RDirectory/HIV_HERV/")
###########Scopetools##################################
####Create a list of sample names

sam_names_dir <- gsub(paste("Raw Data/telescope1/","\\/",sep = ""),"",list.dirs("Raw Data/telescope1/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv <- load_telescope_reports(files = paste("Raw Data/telescope1/",sam_names_dir,"/",sam_names_dir,".tsv", sep = ""), colnames = sam_names_dir)


##filter lowly abundant retrotransposons
cutoff.count <- 5
cutoff.sample <- floor(ncol(raw_herv) * 0.1)
raw_herv <- raw_herv[rowSums(raw_herv > cutoff.count) > cutoff.sample, ]
raw_herv <- raw_herv[!(row.names(raw_herv) %in% "__no_feature"),]
```

##DESEQ2 Gut Biopses
```{r}

ddsf <- read.csv(file = "PRJNA558500MetaData.csv")
ddsf[which(ddsf$disease == ""),"disease"] <- "HIVneg"
ddsf[which(ddsf$disease == "HIV-1"),"disease"] <- "HIVpos"
dds <- DESeqDataSetFromMatrix(countData = raw_herv, colData = ddsf, design = ~ disease)
dds$disease <- relevel(dds$disease, ref = "HIVneg")
dds <- DESeq(dds)
resultsNames(dds)

##disease_HIVpos_vs_HIVneg.

resultsdds <- results(dds, name = "disease_HIVpos_vs_HIVneg")
```

##Make Volcano Plot Gut Biopses

```{r}

pdf("HIV+ vs HIV-.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds, lab = rownames(resultsdds), x = 'log2FoldChange', y = 'pvalue', title = 'Gut Biopsy Retrotranscriptome', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-5, 5), ylim = c(0, 20))

dev.off()


```

##Make PCA Gut Biopses

```{r}
vst <- assay(vst(dds))
p <- pca(vst, metadata = colData(dds), removeVar = 0.1)

pdf("SCREE plot.pdf")
screeplot(p, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot.pdf")
biplot(p, lab = p$disease, labSize = 2, pointSize = 2, colby = 'disease', showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-50,50), title = 'Gut Biopsy Retrotranscriptome')

dev.off()

```

##Summary Data Bar Charts
```{r}
#count_mat: the count matrix; meta = metadata; annotation = TE or gene annotation, the summary category table to build stack plot from; category = the category from annotation table to summarize from; cont = the contrast group from matadata
annotation <- read.delim("TE_annotation.v2.0.tsv", row.names = 1)
meta <- metadata.csv
rownames(meta) <- meta$`ï..Run`
meta[which(meta$disease == ""),"disease"] <- "HIVneg"
meta[which(meta$disease == "HIV-1"),"disease"] <- "HIVpos"
  
abundance_sum <- function(count_mat,meta, annotation, category, cont = "disease"){
  sum_table <- data.frame(matrix(ncol = 5))
  colnames(sum_table) <- c(cont, category, "Count","PCT","AvgCount")
  e.te.annot <- annotation[rownames(count_mat),,drop = FALSE]
  e.te.annot$ids <- rownames(e.te.annot)
  meta$ids <- rownames(meta)
  for(trait in unique(meta[,cont])){
    sample_sub <- meta[which(meta[,cont] == trait),"ids"]
    #print(sample_sub)
    for(sub_cat in unique(e.te.annot[,category])){
      #print(which(e.te.annot[,category] == sub_cat))
      sub_cat_rows <- e.te.annot[which(e.te.annot[,category] == sub_cat),"ids"]
      #print(sub_cat_rows[1])
      count_mat_sub_rows <- count_mat[sub_cat_rows,sample_sub]
      #print(count_mat_sub_rows)
      sum_table[nrow(sum_table) + 1,c(1:3,5)] <- c(trait, sub_cat, sum(count_mat_sub_rows), round(sum(count_mat_sub_rows)/ncol(count_mat_sub_rows),2))
    }
    sum_table$Count <- as.numeric(sum_table$Count)
    sum_table$AvgCount <- as.numeric(sum_table$AvgCount)
    stat_row_sum <- sum(sum_table[which(sum_table[,cont] == trait),"Count"])
    sum_table[which(sum_table[,cont] == trait),4] <- round(((sum_table[which(sum_table[,cont] == trait), "Count"])/stat_row_sum)*100,2)
  }
  sum_table <- sum_table[-1,]
  return(sum_table)
}
```

##Run Function
```{r}

herv_Category <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Category", cont = "disease")

herv_Class <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Class", cont = "disease")

herv_Chrom<- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "Chrom", cont = "disease")

TE_type <- abundance_sum(count_mat = raw_herv,meta = meta, annotation = annotation, category = "TE_type", cont = "disease")

```

##Plot Summary
```{r}
#group
pdf("group_count.pdf")

ggplot(herv_Category, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Category, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

#class
pdf("group_class.pdf")
ggplot(herv_Class, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Class, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

#chrom
pdf("group_chrom.pdf")
ggplot(herv_Chrom, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(Chrom, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

#TE_type
pdf("TE_type.pdf")
ggplot(TE_type, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = AvgCount, fill = reorder(TE_type, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()


#groupPCT
pdf("group_count_pct.pdf")

ggplot(herv_Category, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Category, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

dev.off()

#classPCT
pdf("group_class_pct.pdf")
ggplot(herv_Class, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Class, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

#chromPCT
pdf("group_chrom_pct.pdf")
ggplot(herv_Chrom, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(Chrom, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

#TE_typePCT
pdf("TE_type_pct.pdf")
ggplot(TE_type, aes(x = factor(disease, levels = c("HIVneg", "HIVpos")), y = PCT, fill = reorder(TE_type, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("disease")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

```


##Interferome
```{r}

####Create a list of sample names

sam_names_dir_interferome <- gsub(paste("Raw Data Interferome/telescope1/","\\/",sep = ""),"",list.dirs("Raw Data Interferome/telescope1/"))[-1]

####load_telescope_reports - files: give a list of paths that contain the telescope reports, colnames: column names 
raw_herv_interferome <- load_telescope_reports(files = paste("Raw Data Interferome/telescope1/", sam_names_dir_interferome,"/",sam_names_dir_interferome,".tsv", sep = ""), colnames = sam_names_dir_interferome)


##filter lowly abundant retrotransposons
cutoff.count <- 5
cutoff.sample <- floor(ncol(raw_herv_interferome) * 0.1)
raw_herv_interferome <- raw_herv_interferome[rowSums(raw_herv_interferome > cutoff.count) > cutoff.sample, ]
raw_herv_interferome <- raw_herv_interferome[!(row.names(raw_herv_interferome) %in% "__no_feature"),]
```


##Summary Data Bar Charts Interferome
```{r}
#count_mat: the count matrix; meta = metadata; annotation = TE or gene annotation, the summary category table to build stack plot from; category = the category from annotation table to summarize from; cont = the contrast group from matadata
meta_int <- ddsf_Interferome
rownames(meta_int) <- meta_int$`ï..Run`

  
abundance_sum_int <- function(count_mat,meta, annotation, category, cont = "Library.Name"){
  sum_table <- data.frame(matrix(ncol = 5))
  colnames(sum_table) <- c(cont, category, "Count","PCT","AvgCount")
  e.te.annot <- annotation[rownames(count_mat),,drop = FALSE]
  e.te.annot$ids <- rownames(e.te.annot)
  meta$ids <- rownames(meta)
  for(trait in unique(meta[,cont])){
    sample_sub <- meta[which(meta[,cont] == trait),"ids"]
    #print(sample_sub)
    for(sub_cat in unique(e.te.annot[,category])){
      #print(which(e.te.annot[,category] == sub_cat))
      sub_cat_rows <- e.te.annot[which(e.te.annot[,category] == sub_cat),"ids"]
      #print(sub_cat_rows[1])
      count_mat_sub_rows <- count_mat[sub_cat_rows,sample_sub]
      #print(count_mat_sub_rows)
      sum_table[nrow(sum_table) + 1,c(1:3,5)] <- c(trait, sub_cat, sum(count_mat_sub_rows), round(sum(count_mat_sub_rows)/ncol(count_mat_sub_rows),2))
    }
    sum_table$Count <- as.numeric(sum_table$Count)
    sum_table$AvgCount <- as.numeric(sum_table$AvgCount)
    stat_row_sum <- sum(sum_table[which(sum_table[,cont] == trait),"Count"])
    sum_table[which(sum_table[,cont] == trait),4] <- round(((sum_table[which(sum_table[,cont] == trait), "Count"])/stat_row_sum)*100,2)
  }
  sum_table <- sum_table[-1,]
  return(sum_table)
}
```

##Run Function Interferome
```{r}

herv_Category_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Category", cont = "Library.Name")

herv_Class_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Class", cont = "Library.Name")

herv_Chrom_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "Chrom", cont = "Library.Name")

TE_type_int <- abundance_sum_int(count_mat = raw_herv_interferome,meta = meta_int, annotation = annotation, category = "TE_type", cont = "Library.Name")

```

##Plot Summary Interferome
```{r}
#group
pdf("group_count_int.pdf")

ggplot(herv_Category_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = AvgCount, fill = reorder(Category, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

#class
pdf("group_class_int.pdf")
ggplot(herv_Class_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = AvgCount, fill = reorder(Class, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))

dev.off()

#chrom
pdf("group_chrom_int.pdf")

ggplot(herv_Chrom_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = AvgCount, fill = reorder(Chrom, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()

#TE_type
pdf("TE_type_int.pdf")
ggplot(TE_type_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = AvgCount, fill = reorder(TE_type, -AvgCount))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE_type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))


dev.off()


#groupPCT
pdf("group_count_int_pct.pdf")

ggplot(herv_Category_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = PCT, fill = reorder(Category, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Category")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

#classPCT
pdf("group_class_int_pct.pdf")
ggplot(herv_Class_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = PCT, fill = reorder(Class, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "HERV Class")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

#chromPCT
pdf("group_chrom_int_pct.pdf")
ggplot(herv_Chrom_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = PCT, fill = reorder(Chrom, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "Chrom")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

#TE_typePCT
pdf("TE_type_int_pct.pdf")
ggplot(TE_type_int, aes(x = factor(Library.Name, levels = c("m", "a1", "a2", "a5", "a14", "b")), y = PCT, fill = reorder(TE_type, -PCT))) + geom_bar(stat = "identity", color = "black") + xlab("Library.Name")+ ylab("Average Count Per Sample") + guides(fill = guide_legend(title = "TE_type")) + theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))



dev.off()

```




##DESEQ2 Interferome
```{r}

ddsf_Interferome <- read.csv(file = "PRJNA558974MetaData.csv")
dds_Interferome <- DESeqDataSetFromMatrix(countData = raw_herv_interferome, colData = ddsf_Interferome, design = ~ Library.Name )
dds_Interferome$Library.Name <- relevel(dds_Interferome$Library.Name, ref = "m")
dds_Interferome <- DESeq(dds_Interferome)
resultsNames(dds_Interferome)

##disease_"Library.Name_a1_vs_m"  "Library.Name_a14_vs_m" "Library.Name_a2_vs_m"  "Library.Name_a5_vs_m" "Library.Name_a8_vs_m"  "Library.Name_b_vs_m" 



```


##Make Volcano Plot Library.Name_a1_vs_m

```{r}

resultsdds_Interferome_Library.Name_a1_vs_m <- results(dds_Interferome, name = "Library.Name_a1_vs_m")

pdf("Library.Name_a1_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a1_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a1_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNa1_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```


##Make Volcano Plot Library.Name_a14_vs_m

```{r}

resultsdds_Interferome_Library.Name_a14_vs_m <- results(dds_Interferome, name = "Library.Name_a14_vs_m")

pdf("Library.Name_a14_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a14_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a14_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNa14_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```

##Make Volcano Plot Library.Name_a2_vs_m

```{r}

resultsdds_Interferome_Library.Name_a2_vs_m <- results(dds_Interferome, name = "Library.Name_a2_vs_m")

pdf("Library.Name_a2_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a2_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a2_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNa2_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```


##Make Volcano Plot Library.Name_a5_vs_m

```{r}

resultsdds_Interferome_Library.Name_a5_vs_m <- results(dds_Interferome, name = "Library.Name_a5_vs_m")

pdf("Library.Name_a5_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a5_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a5_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNa5_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```


##Make Volcano Plot Library.Name_a8_vs_m

```{r}

resultsdds_Interferome_Library.Name_a8_vs_m <- results(dds_Interferome, name = "Library.Name_a8_vs_m")

pdf("Library.Name_a8_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_a8_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_a8_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNa8_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```

##Make Volcano Plot Library.Name_b_vs_m

```{r}

resultsdds_Interferome_Library.Name_b_vs_m <- results(dds_Interferome, name = "Library.Name_b_vs_m")

pdf("Library.Name_b_vs_m.pdf")
EnhancedVolcano::EnhancedVolcano(resultsdds_Interferome_Library.Name_b_vs_m, lab = rownames(resultsdds_Interferome_Library.Name_b_vs_m), x = 'log2FoldChange', y = 'pvalue', title = 'IFNb_vs_m', pCutoff = 0.05, FCcutoff = 1, labSize = 2.5,  labFace = 'bold', xlim = c(-10, 10), ylim = c(0, 6.5))

dev.off()


```




##Make PCA Interferome

```{r}
vst_Interferome <- assay(vst(dds_Interferome))
p_Interferome <- pca(vst_Interferome, metadata = colData(dds_Interferome), removeVar = 0.1)

pdf("SCREE plot_Interferome.pdf")
screeplot(p_Interferome, axisLabSize = 10, titleLabSize = 22)

dev.off()

pdf("biplot_Interferome.pdf")
biplot(p_Interferome, lab = p_Interferome$Library.Name, labSize = 2, pointSize = 2, colby = 'Library.Name', showLoadingsNames = TRUE, legendPosition = 'right', encircle = TRUE, xlim = c(-50,50), ylim = c(-50,50), title = 'IFN Stimulation')

dev.off()

```

























##Make Heatmap
```{r}
select <- order(rowMeans(counts(dds,normalized=TRUE)),
                decreasing=TRUE)[1:20]
df <- as.data.frame(colData(resultsdds)[,c("disease")])
pheatmap(assay(dds)[select,], cluster_rows=FALSE, show_rownames=FALSE,
         cluster_cols=FALSE, annotation_col=df)

pheat
```


##Export List of Significantly Altered Retrotransposons
```{r}

ddsSig <- subset(resultsdds, pvalue < 0.05)
ddsSig <- subset(resultsdds, log2FoldChange >= 1 | log2FoldChange <= -1)
ddsSig <- as.data.frame(ddsSig)
write.csv(ddsSig,"Raw Data/ddsSig", row.names = TRUE)

```



```{r}
##Change column names ##Null Unless Wanting Use for downstream analysis
colnames(raw_herv) <- c('PrEP_1', 'PrEP_2', 'PrEP_3', 'PrEP_4', 'PrEP_5', 'PrEP_6', 'PrEP_7', 'PrEP_8', 'PrEP_9','PrEP_10', 'HIV-1_1', 'PrEP_11', 'HIV-1_2', 'HIV-1_3', 'HIV-1_4', 'HIV-1_5', 'HIV-1_6', 'HIV-1_7', 'HIV-1_8', 'HIV-1_9', 'HIV-1_10', 'HIV-1_11', 'HIV-1_12', 'HIV-1_13', 'HIV-1_14', 'HIV-1_15', 'HIV-1_16', 'HIV-1_17', 'HIV-1_18', 'HIV-1_19', 'PrEP_12', 'PrEP_13')

```



